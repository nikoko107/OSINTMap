<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSINTMap - Outil d'Investigation G√©ospatiale</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-search"></i> OSINTMap</h1>
            <p>Outil d'investigation g√©ospatiale pour OpenStreetMap</p>
        </header>

        <div class="main-content">
            <div class="results-panel">
                <div class="map-container">
                    <h3>Carte des r√©sultats</h3>
                    <div class="address-search">
                        <input type="text" id="addressInput" placeholder="Rechercher une adresse..." autocomplete="off">
                        <button type="button" id="searchAddressBtn" class="btn btn-secondary">
                            <i class="fas fa-search"></i>
                        </button>
                        <div id="addressSuggestions" class="address-suggestions" style="display: none;"></div>
                    </div>
                    <div id="map"></div>
                    <div class="map-info">
                        <p><i class="fas fa-info-circle"></i> Clic droit sur un marqueur pour ouvrir OSM ou Street View</p>
                    </div>
                </div>

                <div class="results-info">
                    <div id="resultsCount" class="results-count"></div>
                    <div id="loadingIndicator" class="loading" style="display:none;">
                        <i class="fas fa-spinner fa-spin"></i> Recherche en cours...
                    </div>
                </div>

                <div class="results-list" id="resultsListContainer" style="display:none;">
                    <!-- R√©sultats principaux -->
                    <div class="main-results-section">
                        <h4>üéØ R√©sultats de la recherche</h4>
                        <div class="results-table-container">
                            <table id="mainResultsTable">
                                <thead>
                                    <tr>
                                        <th>Nom</th>
                                        <th>Type</th>
                                        <th>Cat√©gorie OSM</th>
                                        <th>Coordonn√©es</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="mainResultsTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- √âl√©ments compl√©ments -->
                    <div class="complement-results-section" id="complementResultsSection" style="display:none;">
                        <h4>üìç √âl√©ments de r√©f√©rence (compl√©ments)</h4>
                        <div class="results-table-container">
                            <table id="complementResultsTable">
                                <thead>
                                    <tr>
                                        <th>R√¥le</th>
                                        <th>Nom</th>
                                        <th>Type</th>
                                        <th>Cat√©gorie OSM</th>
                                        <th>Coordonn√©es</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="complementResultsTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="export-section">
                    <h3>Export des r√©sultats</h3>
                    <button id="downloadReport" class="btn btn-success" style="display:none;">
                        <i class="fas fa-download"></i> T√©l√©charger le rapport JSON
                    </button>
                    <button id="downloadCSV" class="btn btn-success" style="display:none;">
                        <i class="fas fa-file-csv"></i> T√©l√©charger CSV
                    </button>
                </div>
            </div>
            <div class="search-panel">
                <form id="searchForm">
                    <!-- Mode proximit√© crois√©e uniquement -->
                    <input type="hidden" name="searchMode" value="proximity">

                    <!-- Zone de recherche par bounding box -->
                    <div class="geographic-zone">
                        <h3>Zone de recherche :</h3>
                        <div class="field-group">
                            <label>D√©finir la zone :</label>
                            <div class="bbox-controls">
                                <button type="button" id="drawBbox" class="btn btn-secondary">
                                    <i class="fas fa-draw-polygon"></i> Dessiner sur la carte
                                </button>
                                <button type="button" id="clearBbox" class="btn btn-secondary" style="display:none;">
                                    <i class="fas fa-trash"></i> Effacer la zone
                                </button>
                            </div>
                        </div>
                        <div class="field-group" id="bboxDisplay" style="display:none;">
                            <label>Coordonn√©es de la zone :</label>
                            <div class="bbox-coords">
                                <input type="text" id="bboxCoords" readonly placeholder="Dessinez une zone sur la carte">
                            </div>
                        </div>
                    </div>

                    <!-- √âl√©ment principal √† rechercher -->
                    <div class="main-search">
                        <h3>Quoi chercher :</h3>
                        <div class="condition-fields">
                            <div class="field-group">
                                <label>Cat√©gorie :</label>
                                <select class="category" name="mainCategory" required>
                                    <option value="">S√©lectionner une cat√©gorie</option>
                                </select>
                            </div>

                            <div class="field-group">
                                <label>Types (s√©lection multiple) :</label>
                                <div class="types-container" name="mainTypes">
                                    <p class="no-types">S√©lectionnez d'abord une cat√©gorie</p>
                                </div>
                            </div>

                            <div class="field-group">
                                <label>Recherche par nom (optionnel) :</label>
                                <div class="name-search">
                                    <select class="name-mode" name="mainNameMode">
                                        <option value="">Ignorer le nom</option>
                                        <option value="exact">Nom exact</option>
                                        <option value="contains">Contient</option>
                                        <option value="starts">Commence par</option>
                                    </select>
                                    <input type="text" class="name" name="mainName" placeholder="Texte √† rechercher" disabled>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Compl√©ments de recherche -->
                    <div class="complements-container">
                        <h3>Compl√©ments de recherche :</h3>
                        <div id="complementsContainer">
                            <!-- Les compl√©ments seront ajout√©s ici dynamiquement -->
                        </div>

                        <div class="complement-controls">
                            <button type="button" id="addComplement" class="btn btn-secondary">
                                <i class="fas fa-plus"></i> Ajouter un compl√©ment
                            </button>
                        </div>
                    </div>

                    <div class="controls">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-search"></i> Rechercher
                        </button>

                        <button type="button" id="clearAll" class="btn btn-danger">
                            <i class="fas fa-trash"></i> Effacer tout
                        </button>
                    </div>
                </form>

                <div class="query-section">
                    <h3>Requ√™te Overpass g√©n√©r√©e :</h3>
                    <div id="queryDisplay" class="query-display"></div>
                    <button type="button" id="copyQuery" class="btn btn-secondary">
                        <i class="fas fa-copy"></i> Copier la requ√™te
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
</body>
</html>
